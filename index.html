<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
  <title><!-- === META PREVIEW FOR SOCIAL SHARE === -->
  <meta name="description" content="PumpWolf Dashboard ‚Äî Cyber Meme Utility tracking clean Solana gems in real time. The Wolf Pack never sleeps üê∫‚ú®" />
  <meta property="og:title" content="üê∫ PumpWolf Dashboard ‚Äî Live Token Feed" />
  <meta property="og:description" content="Cyber Meme Utility for Solana Gem Hunters. Track clean tokens, live data, and community howls üß†‚ö°" />
  <meta property="og:image" content="https://raw.githubusercontent.com/3disutisna-afk/pumpwolf/main/assets/pumpwolf_banner.jpg" />
  <meta property="og:url" content="https://3disutisna-afk.github.io/pumpwolf/" />
  <meta property="og:type" content="website" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="üê∫ PumpWolf Dashboard ‚Äî Cyber Meme Utility" />
  <meta name="twitter:description" content="Track early Solana gems with PumpWolf HQ ‚Äî powered by Moralis API." />
  <meta name="twitter:image" content="https://raw.githubusercontent.com/3disutisna-afk/pumpwolf/main/assets/pumpwolf_banner.jpg" />
  <!-- === END META PREVIEW === --></title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    :root{
      --bg:#030406;
      --card:#071018;
      --neon:#00f0ff;
      --accent:#8a2be2;
      --muted:#9bb;
    }
    *{box-sizing:border-box;margin:0;padding:0;}
    body{
      font-family:Inter,system-ui,sans-serif;
      background:radial-gradient(circle at 10% 10%,#02030a 0%,var(--bg) 60%);
      color:#dff;
      overflow-x:hidden;
    }
    header{
      padding:18px 16px;display:flex;align-items:center;gap:12px;
      border-bottom:1px solid rgba(0,255,255,0.05);
    }
    header .logo{
      width:52px;height:52px;border-radius:10px;
      background:radial-gradient(circle at 30% 30%,#002,#013);
      display:flex;align-items:center;justify-content:center;
      box-shadow:0 0 18px rgba(0,240,255,0.1);
      font-weight:700;font-size:1rem;
    }
    header h1{margin:0;font-size:1.1rem;color:var(--neon);}
    .muted{color:var(--muted);font-size:0.9rem;}
    .layout{
      display:flex;gap:20px;padding:16px;align-items:flex-start;
    }
    .col-left{width:280px;min-width:260px;}
    .col-main{flex:1;}
    .card{
      background:linear-gradient(180deg,rgba(255,255,255,0.01),rgba(255,255,255,0.015));
      border:1px solid rgba(0,240,255,0.06);
      border-radius:12px;padding:14px;margin-bottom:14px;
      box-shadow:0 6px 24px rgba(0,0,0,0.5);
    }
    .btn{
      background:linear-gradient(90deg,var(--neon),var(--accent));
      border:none;color:#001;padding:8px 12px;border-radius:10px;
      font-weight:700;cursor:pointer;text-decoration:none;
      box-shadow:0 6px 24px rgba(0,240,255,0.06);
      transition:transform .2s ease;
    }
    .btn:hover{transform:scale(1.04);}
    .small{padding:6px 10px;font-size:0.85rem;}
    .tiny{font-size:0.8rem;color:var(--muted);}
    .token-list{
      display:flex;flex-direction:column;gap:10px;max-height:65vh;overflow:auto;padding-right:6px;
    }
    .token{
      display:flex;justify-content:space-between;align-items:center;gap:10px;
      padding:10px;border-radius:10px;
      background:linear-gradient(90deg,rgba(0,0,0,0.16),rgba(0,0,0,0.06));
      border:1px solid rgba(0,240,255,0.03);
      transition:transform .2s ease, box-shadow .2s ease;
    }
    .token:hover{transform:translateY(-3px);box-shadow:0 8px 20px rgba(0,240,255,0.06);}
    footer{text-align:center;padding:14px 20px;color:var(--muted);font-size:0.85rem;}
    /* === Featured Token === */
    .howl-bar{
      height:10px;border-radius:8px;background:rgba(255,255,255,0.05);
      overflow:hidden;margin-top:6px;box-shadow:inset 0 0 6px rgba(0,240,255,0.1);
    }
    .howl-bar .fill{
      height:100%;width:0%;background:linear-gradient(90deg,#00f0ff,#8a2be2);
      animation:howlGrow 3s ease-in-out infinite alternate;
    }
    @keyframes howlGrow{0%{width:40%}100%{width:90%}}
    /* === Responsive === */
    @media(max-width:900px){
      .layout{flex-direction:column;padding:10px;}
      .col-left{width:100%;}
      .col-main{width:100%;}
      header{flex-direction:row;gap:10px;}
    }
    @media(max-width:500px){
      header .logo{width:46px;height:46px;}
      header h1{font-size:1rem;}
      .btn{font-size:0.8rem;}
      .card{padding:10px;}
    }
  </style>
</head>
<body>

<header>
  <div class="logo">PW</div>
  <div>
    <h1>PumpWolf Dashboard</h1>
    <div class="muted">Cyber Meme Utility ‚Äî Wolf Pack Live üê∫</div>
  </div>
</header>

<div class="layout">
  <aside class="col-left">
    <div class="card">
      <div class="muted">API Status</div>
      <div id="api-status" style="color:var(--neon);margin-top:4px;">Moralis: ready</div>
      <div class="muted" style="margin-top:10px;">Last update: <span id="last-update">‚Äî</span></div>
    </div>
    <div class="card">
      <div class="muted">Filters</div>
      <div style="margin-top:8px;">
        <button class="btn small" id="refreshBtn">Refresh</button>
        <button class="btn small" id="pauseBtn">Pause</button>
      </div>
    </div>
  </aside>

  <main class="col-main">

    <!-- === FEATURED TOKEN SECTION === -->
    <div class="card" id="featuredToken">
      <div style="display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;">
        <div>
          <div class="muted" style="font-size:0.9rem;">üî• Featured Token</div>
          <h2 style="color:var(--neon);margin:6px 0;">$WOLF ‚Äî The Cyber Meme Wolf</h2>
          <div class="tiny" id="wolfData">Loading live data...</div>
        </div>
        <img src="https://raw.githubusercontent.com/3disutisna-afk/pumpwolf/main/assets/wolf_logo.png"
          alt="$WOLF" style="width:60px;height:60px;border-radius:12px;box-shadow:0 0 18px rgba(0,240,255,0.25);margin-top:6px;">
      </div>

      <div class="howl-bar"><div class="fill"></div></div>

      <div style="margin-top:12px;display:flex;gap:6px;flex-wrap:wrap;">
        <a href="https://pump.fun/coin/YOUR_TOKEN_ADDRESS" target="_blank" class="btn small">üíß Buy on Pump.fun</a>
        <a href="https://solscan.io/token/YOUR_TOKEN_ADDRESS?cluster=mainnet" target="_blank" class="btn small">üîé Solscan</a>
      </div>
    </div>
    <!-- === END FEATURED TOKEN === -->

    <div class="card">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;flex-wrap:wrap;">
        <div><b style="color:var(--neon)">Live Tokens</b> <span class="muted">‚Äî auto-updated from Moralis</span></div>
        <div class="muted" style="font-size:0.8rem;">Refresh: <span id="interval-label">60s</span></div>
      </div>
      <div id="tokenContainer" class="token-list"></div>
    </div>

  </main>
</div>

<footer>¬© 2025 PumpWolf ‚Äî The Cyber Pack ‚Ä¢ v2.1 (Mobile Optimized)</footer>

<script>
/* ===== Enhanced token rendering + modal (paste/replace script block) ===== */

const MORALIS_API_KEY = "YOUR_MORALIS_API_KEY"; // key dikelola di Vercel
const ENDPOINT = "/api/proxy/token/mainnet/exchange/pumpfun/new?limit=100";
const MIN_LIQUIDITY = 5000;
const POLL_INTERVAL = 60000;

const apiStatusEl = document.getElementById('api-status');
const lastUpdateEl = document.getElementById('last-update');
const tokenContainer = document.getElementById('tokenContainer');

window.tokenMap = {}; // global store: addr -> item

// --- enhanced fetchTokens (stores items and adds data-addr to cards) ---
async function fetchTokens(){
  apiStatusEl.textContent = 'Fetching...';
  try{
    const res = await fetch(ENDPOINT, { headers: { "X-API-Key": MORALIS_API_KEY, "accept": "application/json" }});
    const data = await res.json();
    const items = Array.isArray(data.result) ? data.result : [];
    const filtered = items.filter(it => Number(it.liquidity || 0) >= MIN_LIQUIDITY);

    // clear previous map & DOM
    window.tokenMap = {};
    tokenContainer.innerHTML = '';

    filtered.forEach(it => {
      // normalize address key (Moralis uses tokenAddress)
      const addr = it.tokenAddress || it.address || it.token_address || ('addr_' + Math.random().toString(36).slice(2,9));
      window.tokenMap[addr] = it;

      const div = document.createElement('div');
      div.className = 'token';
      // store address on element so delegated handler can find it
      div.dataset.addr = addr;

      // safe formatting
      const liquidity = Number(it.liquidity || 0);
      const fdv = Number(it.fullyDilutedValuation || it.fdv || 0);
      const createdAt = it.createdAt ? new Date(it.createdAt).toLocaleTimeString() : '‚Äî';

      div.innerHTML = `
        <div>
          <div><b style="color:var(--neon)">${it.symbol || '?'}</b> ‚Äî ${it.name || 'Unnamed'}</div>
          <div class="tiny">üíß $${isFinite(liquidity) ? liquidity.toLocaleString() : '‚Äî'} ‚Ä¢ üßÆ FDV: $${isFinite(fdv) ? fdv.toLocaleString() : '‚Äî'}</div>
        </div>
        <div class="tiny">${createdAt}</div>
      `;
      tokenContainer.appendChild(div);
    });

    apiStatusEl.textContent = 'Moralis: OK';
    lastUpdateEl.textContent = new Date().toLocaleTimeString();
  } catch (e) {
    console.error(e);
    apiStatusEl.textContent = 'Error fetching';
  }
}

// periodic refresh
setInterval(fetchTokens, POLL_INTERVAL);
fetchTokens();

/* ===== delegated click handler for token cards =====
   Finds the clicked .token element, reads data-addr, looks up tokenMap,
   opens modal with details and buttons to Pump.fun / Solscan.
*/
(function setupTokenClickModal(){
  // create modal element (lightweight)
  let modal = document.createElement('div');
  modal.className = 'pw-modal';
  modal.style.position = 'fixed';
  modal.style.inset = '0';
  modal.style.display = 'none';
  modal.style.alignItems = 'center';
  modal.style.justifyContent = 'center';
  modal.style.zIndex = 9999;
  modal.style.backdropFilter = 'blur(6px) saturate(120%)';
  modal.innerHTML = `
    <div style="width:min(720px,94%);max-height:86vh;overflow:auto;padding:18px;border-radius:12px;background:linear-gradient(135deg, rgba(2,6,10,0.96), rgba(6,8,16,0.99));border:1px solid rgba(0,240,255,0.06);box-shadow:0 30px 80px rgba(0,0,0,0.7);color:#dff">
      <button class="closeBtn" style="float:right;background:transparent;border:0;color:#9fe;font-size:20px;cursor:pointer">‚úï</button>
      <div style="display:flex;gap:12px;align-items:center;">
        <img id="mLogo" src="" style="width:64px;height:64px;border-radius:8px;object-fit:cover;box-shadow:0 0 20px rgba(0,240,255,0.08)"/>
        <div>
          <h2 id="mName" style="margin:0;color:var(--neon)"></h2>
          <div id="mSymbol" class="tiny" style="margin-top:6px"></div>
        </div>
      </div>
      <div id="mChartWrap" style="height:110px;margin-top:12px;background:linear-gradient(180deg, rgba(0,0,0,0.02), rgba(0,0,0,0.04));border-radius:8px;padding:8px;"></div>
      <div id="mDetails" style="display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-top:12px;"></div>
      <div style="margin-top:12px;display:flex;gap:8px;flex-wrap:wrap;justify-content:flex-end">
        <a id="mPump" class="btn small" target="_blank" style="text-decoration:none">Open on Pump.fun</a>
        <a id="mExplorer" class="btn small" target="_blank" style="text-decoration:none">Open on Explorer</a>
        <a id="mSolscan" class="btn small" target="_blank" style="text-decoration:none">Open on Solscan</a>
      </div>
    </div>
  `;
  document.body.appendChild(modal);

  // close button
  modal.querySelector('.closeBtn').onclick = () => modal.style.display = 'none';
  // click outside to close
  modal.addEventListener('click', (ev) => { if(ev.target === modal) modal.style.display = 'none'; });

  // delegated click on container
  tokenContainer.addEventListener('click', (ev) => {
    const tokenEl = ev.target.closest('.token');
    if(!tokenEl) return;
    const addr = tokenEl.dataset.addr;
    if(!addr) return;
    const item = window.tokenMap[addr];
    if(!item) return;

    // fill modal
    modal.style.display = 'flex';
    modal.querySelector('#mLogo').src = item.logo || ('https://logo.moralis.io/solana-mainnet_' + addr + '_placeholder.png');
    modal.querySelector('#mName').textContent = item.name || 'Unnamed';
    modal.querySelector('#mSymbol').textContent = (item.symbol || '‚Äî') + ' ‚Ä¢ ' + (addr ? (addr.slice(0,6) + '...') : '');
    // details grid
    const details = modal.querySelector('#mDetails');
    const price = item.priceUsd ? ('$' + Number(item.priceUsd).toLocaleString()) : '‚Äî';
    const liquidity = item.liquidity ? ('$' + Number(item.liquidity).toLocaleString()) : '‚Äî';
    const fdv = item.fullyDilutedValuation ? ('$' + Number(item.fullyDilutedValuation).toLocaleString()) : '‚Äî';
    const created = item.createdAt ? new Date(item.createdAt).toLocaleString() : '‚Äî';
    details.innerHTML = `
      <div style="background:rgba(255,255,255,0.01);padding:8px;border-radius:8px;border:1px solid rgba(0,240,255,0.03)">
        <div class="tiny">Price (USD)</div><div style="color:var(--neon);font-weight:700">${price}</div>
      </div>
      <div style="background:rgba(255,255,255,0.01);padding:8px;border-radius:8px;border:1px solid rgba(0,240,255,0.03)">
        <div class="tiny">Liquidity</div><div style="color:var(--neon);font-weight:700">${liquidity}</div>
      </div>
      <div style="background:rgba(255,255,255,0.01);padding:8px;border-radius:8px;border:1px solid rgba(0,240,255,0.03)">
        <div class="tiny">FDV</div><div style="color:var(--neon);font-weight:700">${fdv}</div>
      </div>
      <div style="background:rgba(255,255,255,0.01);padding:8px;border-radius:8px;border:1px solid rgba(0,240,255,0.03)">
        <div class="tiny">Created</div><div style="color:var(--neon);font-weight:700">${created}</div>
      </div>
    `;

    // buttons
    const pumpfunUrl = addr ? `https://pump.fun/coin/${addr}` : '#';
    const solanaExplorer = addr ? `https://explorer.solana.com/address/${encodeURIComponent(addr)}?cluster=mainnet` : '#';
    const solscanToken = addr ? `https://solscan.io/token/${encodeURIComponent(addr)}?cluster=mainnet` : '#';
    modal.querySelector('#mPump').href = pumpfunUrl;
    modal.querySelector('#mExplorer').href = solanaExplorer;
    modal.querySelector('#mSolscan').href = solscanToken;

    // small sparkline (if price history exists) else fallback sample
    const chartWrap = modal.querySelector('#mChartWrap');
    chartWrap.innerHTML = '';
    const canvas = document.createElement('canvas');
    canvas.style.width = '100%';
    canvas.style.height = '100%';
    chartWrap.appendChild(canvas);
    const ctx = canvas.getContext('2d');
    const sparkData = (Array.isArray(item.price_history) && item.price_history.length) ? item.price_history.map(x=>Number(x)).slice(-40) : Array.from({length:20}, (_,i)=> (Number(item.priceUsd||0) || Math.random()*0.00001) * (1 + (Math.sin(i/3)*0.002 + (Math.random()-0.5)*0.01)));
    if(window._mChart){ try{ window._mChart.destroy(); }catch(e){} window._mChart = null; }
    window._mChart = new Chart(ctx, {
      type:'line',
      data:{ labels:sparkData.map((_,i)=>i), datasets:[{ data:sparkData, borderColor:'rgba(0,240,255,0.95)', borderWidth:1.6, pointRadius:0, fill:true, backgroundColor:'rgba(0,240,255,0.04)'}] },
      options:{ responsive:true, maintainAspectRatio:false, scales:{ x:{ display:false }, y:{ display:false } }, plugins:{ legend:{ display:false } } }
    });
  });
})();
</script>
