<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PumpWolf Dashboard ‚Äî Cyber Meme Utility</title>

  <meta name="description" content="PumpWolf Dashboard ‚Äî Cyber Meme Utility tracking clean Solana gems in real time." />
  <meta property="og:title" content="üê∫ PumpWolf Dashboard ‚Äî Live Token Feed" />
  <meta property="og:description" content="Cyber Meme Utility for Solana Gem Hunters. Track clean tokens, live data, and community howls." />
  <meta property="og:image" content="https://raw.githubusercontent.com/3disutisna-afk/pumpwolf/main/assets/pumpwolf_banner.jpg" />
  <meta property="og:url" content="https://3disutisna-afk.github.io/pumpwolf/" />
  <meta name="twitter:card" content="summary_large_image" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    :root {
      --bg:#030406; --card:#071018; --neon:#00f0ff; --accent:#8a2be2; --muted:#9bb;
    }
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:Inter,system-ui,sans-serif;background:radial-gradient(circle at 10% 10%,#02030a 0%,var(--bg) 60%);color:#dff}
    header{padding:18px 16px;display:flex;align-items:center;gap:12px;border-bottom:1px solid rgba(0,255,255,0.05)}
    header .logo{width:52px;height:52px;border-radius:10px;background:radial-gradient(circle at 30% 30%,#002,#013);display:flex;align-items:center;justify-content:center;box-shadow:0 0 18px rgba(0,240,255,0.1);font-weight:700}
    header h1{margin:0;font-size:1.05rem;color:var(--neon)}
    .muted{color:var(--muted);font-size:0.9rem}
    .layout{display:flex;gap:16px;padding:16px;align-items:flex-start}
    .col-left{width:280px;min-width:240px}
    .col-main{flex:1}
    .card{background:linear-gradient(180deg,rgba(255,255,255,0.01),rgba(255,255,255,0.015));border:1px solid rgba(0,240,255,0.06);border-radius:12px;padding:14px;margin-bottom:14px;box-shadow:0 6px 24px rgba(0,0,0,0.45)}
    .btn{background:linear-gradient(90deg,var(--neon),var(--accent));border:none;color:#001;padding:8px 12px;border-radius:10px;font-weight:700;cursor:pointer;text-decoration:none;display:inline-block}
    .small{padding:6px 10px;font-size:0.85rem}
    .tiny{font-size:0.82rem;color:var(--muted)}
    .token-list{display:flex;flex-direction:column;gap:10px;max-height:65vh;overflow:auto;padding-right:6px}
    .token{display:flex;justify-content:space-between;align-items:center;gap:10px;padding:10px;border-radius:10px;background:linear-gradient(90deg,rgba(0,0,0,0.16),rgba(0,0,0,0.06));border:1px solid rgba(0,240,255,0.03);transition:transform .18s ease,box-shadow .18s ease}
    .token:hover{transform:translateY(-3px);box-shadow:0 8px 20px rgba(0,240,255,0.06)}
    footer{text-align:center;padding:14px 20px;color:var(--muted);font-size:0.85rem}
    .howl-bar{height:10px;border-radius:8px;background:rgba(255,255,255,0.03);overflow:hidden;margin-top:8px;box-shadow:inset 0 0 6px rgba(0,240,255,0.08)}
    .debug{font-family:ui-monospace,monospace;font-size:13px;color:#c8fff6;white-space:pre-wrap;overflow:auto;max-height:220px;padding:12px;background:rgba(0,0,0,0.22);border-radius:8px;border:1px solid rgba(0,240,255,0.03)}
    @media(max-width:900px){.layout{flex-direction:column}.col-left{width:100%}}
  </style>
</head>

<body>
  <header>
    <div class="logo">PW</div>
    <div>
      <h1>PumpWolf Dashboard</h1>
      <div class="muted">Cyber Meme Utility ‚Äî Wolf Pack Live üê∫</div>
    </div>
  </header>

  <div class="layout">
    <aside class="col-left">
      <div class="card">
        <div class="muted">API Status</div>
        <div id="api-status" style="color:var(--neon);margin-top:6px">Proxy: ready</div>
        <div class="muted" style="margin-top:8px">Last update: <span id="last-update">‚Äî</span></div>
      </div>
      <div class="card">
        <div class="muted">Controls</div>
        <div style="margin-top:10px;display:flex;gap:8px;flex-wrap:wrap">
          <button class="btn small" id="refreshBtn">Refresh</button>
          <button class="btn small" id="pauseBtn">Pause</button>
        </div>
      </div>
      <div class="card">
        <div class="muted">Debug panel (fetch status & headers)</div>
        <div id="debugPanel" class="debug">[debug output appears here]</div>
      </div>
    </aside>

    <main class="col-main">
      <div class="card" id="featuredToken">
        <div style="display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap">
          <div>
            <div class="muted" style="font-size:0.9rem">üî• Featured Token</div>
            <h2 style="color:var(--neon);margin:6px 0" id="featuredTitle">$WOLF ‚Äî The Cyber Meme Wolf</h2>
            <div class="tiny" id="wolfData">Loading live data...</div>
          </div>
          <img id="featuredLogo" src="https://raw.githubusercontent.com/3disutisna-afk/pumpwolf/main/assets/wolf_logo.png" alt="$WOLF" style="width:60px;height:60px;border-radius:12px;box-shadow:0 0 18px rgba(0,240,255,0.25);margin-top:6px">
        </div>
        <div class="howl-bar"><div id="howlFill" style="width:50%;background:var(--neon);height:100%"></div></div>
        <div style="margin-top:12px;display:flex;gap:8px;flex-wrap:wrap">
          <a id="btnBuy" class="btn small" href="#" target="_blank">üíß Buy on Pump.fun</a>
          <a id="btnSolscan" class="btn small" href="#" target="_blank">üîé Solscan</a>
        </div>
      </div>

      <div class="card">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;flex-wrap:wrap">
          <div><b style="color:var(--neon)">Live Tokens</b> <span class="muted">‚Äî auto-updated from Moralis (via proxy)</span></div>
          <div class="muted" style="font-size:0.85rem">Refresh: <span id="interval-label">60s</span></div>
        </div>
        <div id="tokenContainer" class="token-list"><div class="tiny">Loading...</div></div>
      </div>
    </main>
  </div>

  <footer>¬© 2025 PumpWolf ‚Äî The Cyber Pack ‚Ä¢ v2.3</footer>

  <script>
  (function(){
    const VERCEL_BASE = "https://pumpwolf.vercel.app";
    const ENDPOINT = VERCEL_BASE + "/api/proxy/token/mainnet/exchange/pumpfun/new?limit=100";
    const FEATURE_PRICE_URL = (a)=>VERCEL_BASE+`/api/proxy/token/mainnet/${a}/price`;
    const FEATURED_TOKEN_ADDRESS = "";
    const POLL_INTERVAL = 60000, MIN_LIQ = 5000;

    const api = document.getElementById('api-status'),
          last = document.getElementById('last-update'),
          list = document.getElementById('tokenContainer'),
          dbg = document.getElementById('debugPanel');
    let timer, paused=false; window.tokenMap={};

    function debugLog(...a){
      try{
        const t=new Date().toLocaleTimeString();
        let s=a.map(v=>typeof v==='string'?v.replace(/[<>]/g,c=>({'<':'&lt;','>':'&gt;'}[c])):JSON.stringify(v,null,2)).join(' ');
        if(s.length>2000)s=s.slice(0,2000)+' ‚Ä¶[truncated]';
        dbg.textContent=`[${t}] ${s}\n\n`+dbg.textContent;
      }catch(e){console.log(...a)}
    }

    async function fetchTokens(){
      api.textContent='Fetching...';
      try{
        const res=await fetch(ENDPOINT,{headers:{accept:"application/json"}});
        debugLog("Status:",{ok:res.ok,status:res.status});
        if(!res.ok){
          const text=await res.text().catch(()=>"[no body]");
          debugLog("Non-ok body:",text.slice(0,1000));
          api.textContent=`Proxy error ${res.status}`; 
          list.innerHTML=`<div class='tiny'>Proxy returned ${res.status}</div>`;
          last.textContent=new Date().toLocaleTimeString(); return;
        }
        const data=await res.json().catch(()=>null);
        if(!data||!Array.isArray(data.result)){
          api.textContent='Malformed JSON';
          list.innerHTML=`<div class='tiny'>Invalid data</div>`;
          debugLog("Bad JSON:",data); return;
        }
        const f=data.result.filter(x=>+x.liquidity>=MIN_LIQ);
        list.innerHTML=''; window.tokenMap={};
        if(!f.length) list.innerHTML=`<div class='tiny'>No tokens ‚â• ${MIN_LIQ}</div>`;
        else f.forEach(x=>{
          const a=x.tokenAddress||'addr_'+Math.random();
          window.tokenMap[a]=x;
          const d=document.createElement('div');
          d.className='token'; d.dataset.addr=a;
          d.innerHTML=`
            <div>
              <div><b style="color:var(--neon)">${escape(x.symbol)}</b> ‚Äî ${escape(x.name)}</div>
              <div class="tiny">üíß $${(+x.liquidity).toLocaleString()} ‚Ä¢ üßÆ FDV: $${(+x.fullyDilutedValuation).toLocaleString()}</div>
            </div>
            <div class="tiny">${x.createdAt?new Date(x.createdAt).toLocaleTimeString():'‚Äî'}</div>`;
          list.appendChild(d);
        });
        api.textContent='Proxy: OK'; last.textContent=new Date().toLocaleTimeString();
      }catch(e){debugLog("Fetch error",e); api.textContent='Proxy: fail';}
    }

    function escape(s){return String(s||'').replace(/[&<>"']/g,c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]))}
    function start(){stop(); timer=setInterval(fetchTokens,POLL_INTERVAL)}
    function stop(){if(timer)clearInterval(timer)}

    document.getElementById('refreshBtn').onclick=fetchTokens;
    document.getElementById('pauseBtn').onclick=()=>{paused=!paused;paused?stop():start();event.target.textContent=paused?'Resume':'Pause'};

    // featured
    async function loadFeatured(){
      const addr=FEATURED_TOKEN_ADDRESS, el=document.getElementById('wolfData');
      if(!addr){el.textContent='Featured token not set.';return;}
      try{
        const r=await fetch(FEATURE_PRICE_URL(addr));const j=await r.json();
        el.innerHTML=`üí∞ Price: <b>$${(+j.usdPrice).toFixed(6)}</b>`;
      }catch(e){el.textContent='Error loading featured';}
    }

    fetchTokens();loadFeatured();start();
  })();
  </script>

  <!-- Cleanup in case any HTML text accidentally rendered -->
  <script>
  (function(){
    const walker=document.createTreeWalker(document.body,NodeFilter.SHOW_TEXT);
    const rm=[];while(walker.nextNode()){
      const v=walker.currentNode.nodeValue?.trim();
      if(v&&(v.startsWith('<!DOCTYPE')||v.startsWith('<html')||v.startsWith('<head')||v.startsWith('<script'))&&v.length>30)
        rm.push(walker.currentNode);
    }rm.forEach(n=>n.parentNode&&n.parentNode.removeChild(n));
  })();
  </script>
</body>
</html>
