<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PumpWolf ‚Äî Cyber Meme Utility</title>
  <meta name="description" content="PumpWolf: Track high-potential Solana meme tokens in real-time. Join the Wolf Pack! üê∫" />
  <meta property="og:title" content="üê∫ PumpWolf ‚Äî Live Solana Gems" />
  <meta property="og:description" content="Discover safe, high-potential tokens on Solana with PumpWolf. Live data, no hype, just value." />
  <meta property="og:image" content="https://raw.githubusercontent.com/3disutisna-afk/pumpwolf/main/assets/pumpwolf_banner.jpg" />
  <meta property="og:url" content="https://pumpwolf.vercel.app/" />
  <meta name="twitter:card" content="summary_large_image" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <style>
    :root { --bg: #030406; --card: #071018; --neon: #00f0ff; --accent: #8a2be2; --muted: #9bb; }
    * { box-sizing: border-box; margin: 0; padding: 0 }
    body { font-family: Inter, system-ui, sans-serif; background: radial-gradient(circle at 10% 10%, #02030a 0%, var(--bg) 60%); color: #dff; padding: 16px; }
    header { padding: 18px 0; text-align: center; border-bottom: 1px solid rgba(0,255,255,0.05) }
    header .logo { width: 64px; height: 64px; border-radius: 10px; object-fit: contain; box-shadow: 0 0 18px rgba(0,240,255,0.1) }
    header h1 { margin: 8px 0 0; font-size: 1.2rem; color: var(--neon) } .muted { color: var(--muted); font-size: 0.9rem }
    .card { background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.015)); border: 1px solid rgba(0,240,255,0.06); border-radius: 12px; padding: 14px; margin-bottom: 14px; box-shadow: 0 6px 24px rgba(0,0,0,0.45) }
    .token-list { display: flex; flex-direction: column; gap: 10px; max-height: 70vh; overflow: auto; padding-right: 6px }
    .token { display: flex; justify-content: space-between; align-items: center; gap: 10px; padding: 10px; border-radius: 10px; background: linear-gradient(90deg, rgba(0,0,0,0.16), rgba(0,0,0,0.06)); border: 1px solid rgba(0,240,255,0.03); transition: transform .18s ease, box-shadow .18s ease; cursor: pointer }
    .token:hover { transform: translateY(-3px); box-shadow: 0 8px 20px rgba(0,240,255,0.06) }
    .tiny { font-size: 0.82rem; color: var(--muted) }
    .btn { background: linear-gradient(90deg, var(--neon), var(--accent)); border: none; color: #001; padding: 8px 12px; border-radius: 10px; font-weight: 700; cursor: pointer; text-decoration: none }
    .debug { display: none; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", monospace; font-size: 13px; color: #c8fff6; white-space: pre-wrap; overflow: auto; max-height: 200px; padding: 12px; background: rgba(0,0,0,0.22); border-radius: 8px; border: 1px solid rgba(0,240,255,0.03); margin-top: 10px }
    .debug.visible { display: block }
    @media (max-width: 600px) { .card { padding: 10px } header .logo { width: 48px; height: 48px } header h1 { font-size: 1rem } }
  </style>
</head>
<body>
  <header>
    <img class="logo" src="https://raw.githubusercontent.com/3disutisna-afk/pumpwolf/main/assets/wolf_logo.png" alt="PumpWolf" onerror="this.src='https://via.placeholder.com/64?text=PW'" />
    <h1>PumpWolf</h1>
    <div class="muted">Cyber Meme Utility ‚Äî Live Solana Gems üê∫</div>
  </header>

  <div class="card">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
      <div><b style="color:var(--neon)">High-Potential Tokens</b> <span class="muted">‚Äî Auto-updated (local fallback if offline)</span></div>
      <button class="btn" id="refreshBtn">Refresh</button>
    </div>
    <div id="tokenContainer" class="token-list">
      <div class="tiny">Loading tokens...</div>
    </div>
    <div id="debugPanel" class="debug"></div>
  </div>

  <script>
    const MORALIS_API_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJub25jZSI6Ijc3YTQ1MjhhLTYwY2YtNDJkZi04YzQ1LTgwYThhMmIyNTc1NyIsIm9yZ0lkIjoiNDQwOTM1IiwidXNlcklkIjoiNDUzNjQxIiwidHlwZUlkIjoiOTcyYzFhMjgtZTNkYi00NjIwLWE5Y2MtZmNkODk1ZDFjODgzIiwidHlwZSI6IlBST0pFQ1QiLCJpYXQiOjE3NDQyODU1NjIsImV4cCI6NDkwMDA0NTU2Mn0.u7fKhRKYKuZyArx_DD1fmttQRtT6hXBQwtBOO2XUPaY"; // Ganti dengan API key Moralis kakak
    const VERCEL_BASE = "https://pumpwolf.vercel.app";
    const ENDPOINT = VERCEL_BASE + "/api/proxy/token/mainnet/exchange/pumpfun/new?limit=50";
    const MIN_LIQUIDITY = 300; // $300
    const MAX_FDV = 1000000; // $1M
    const MIN_VOLUME_24H = 100; // $100
    const MIN_AGE_MIN = 0.05; // 0.05 menit

    const tokenContainer = document.getElementById('tokenContainer');
    const debugPanel = document.getElementById('debugPanel');
    const refreshBtn = document.getElementById('refreshBtn');

    function debugLog(...args) {
      if (!debugPanel.classList.contains('visible')) debugPanel.classList.add('visible');
      const t = new Date().toLocaleTimeString();
      const s = args.map(a => (typeof a === 'string' ? a : JSON.stringify(a, null, 2))).join(' ');
      debugPanel.textContent += `[${t}] ${s}\n`;
      debugPanel.scrollTop = debugPanel.scrollHeight;
    }

    async function fetchJson(url) {
      try {
        debugLog(`Fetching ${url}`);
        const controller = new AbortController();
        const timeoutId = setTimeout(() => controller.abort(), 15000); // 15 detik timeout
        const res = await fetch(url, { signal: controller.signal, headers: { "X-API-Key": MORALIS_API_KEY, "accept": "application/json" } });
        clearTimeout(timeoutId);
        if (!res.ok) throw new Error(`HTTP ${res.status}: ${res.statusText}`);
        const data = await res.json();
        debugLog(`Fetched data:`, data);
        return data;
      } catch (err) {
        debugLog("Fetch error:", err.message);
        return null;
      }
    }

    function filterSafeTokens(tokens) {
      const now = new Date();
      return tokens.filter(it => {
        const liq = Number(it.liquidity || 0);
        const fdv = Number(it.fullyDilutedValuation || 0);
        const vol = Number(it.volume24h || 0);
        const ageMin = (now - new Date(it.createdAt || now)) / (1000 * 60);
        return liq >= MIN_LIQUIDITY && fdv <= MAX_FDV && vol >= MIN_VOLUME_24H && ageMin >= MIN_AGE_MIN;
      }).slice(0, 10);
    }

    const dummyTokens = [
      { tokenAddress: "8u6hFr2SPrX5GxDdG4wH8kEZfaHSPoULHh3AEFvspump", name: "CyberWolf Meme", symbol: "WOLF1", priceUsd: "0.000005", liquidity: "400", fullyDilutedValuation: "1500", volume24h: "150", createdAt: "2025-10-21T15:55:00Z", logo: "https://raw.githubusercontent.com/3disutisna-afk/pumpwolf/main/assets/wolf_logo.png" },
      { tokenAddress: "FhiPLfoZJkDmu7whn6Yoovdh3SR7iaAXbgyU2aSApump", name: "MoonWolf", symbol: "MOONW", priceUsd: "0.000007", liquidity: "500", fullyDilutedValuation: "2000", volume24h: "200", createdAt: "2025-10-21T15:56:00Z", logo: "https://raw.githubusercontent.com/3disutisna-afk/pumpwolf/main/assets/wolf_logo.png" },
      { tokenAddress: "SMACKR1234567890AbCdEfGhIjKlMnOpQrStUvWxYpump", name: "SMACKR Wolf", symbol: "SMACKW", priceUsd: "0.000010", liquidity: "600", fullyDilutedValuation: "2500", volume24h: "250", createdAt: "2025-10-21T15:57:00Z", logo: "https://raw.githubusercontent.com/3disutisna-afk/pumpwolf/main/assets/wolf_logo.png" },
      { tokenAddress: "TEST1234567890AbCdEfGhIjKlMnOpQrStUvWxYpump", name: "AlphaWolf", symbol: "ALPHAW", priceUsd: "0.000008", liquidity: "350", fullyDilutedValuation: "1800", volume24h: "180", createdAt: "2025-10-21T15:58:00Z", logo: "https://raw.githubusercontent.com/3disutisna-afk/pumpwolf/main/assets/wolf_logo.png" },
    ];

    async function fetchTokens(retry = 3) {
      if (retry === 0) {
        debugLog("API failed after retries, using dummy data");
        renderTokens(dummyTokens);
        return;
      }
      try {
        const data = await fetchJson(ENDPOINT);
        if (!data || !data.result || !Array.isArray(data.result)) throw new Error('Invalid API data');
        const filtered = filterSafeTokens(data.result.map(t => ({ ...t, logo: "https://raw.githubusercontent.com/3disutisna-afk/pumpwolf/main/assets/wolf_logo.png" })));
        if (filtered.length === 0) {
          debugLog("No tokens passed filter, using dummy data");
          renderTokens(dummyTokens);
        } else {
          renderTokens(filtered);
        }
      } catch (err) {
        debugLog("Fetch failed, retrying:", err.message);
        setTimeout(() => fetchTokens(retry - 1), 4000); // Retry every 4 detik
      }
    }

    function renderTokens(tokens) {
      tokenContainer.innerHTML = '';
      if (!tokens.length) {
        tokenContainer.innerHTML = `<div class="tiny">No tokens available (check API or refresh)</div>`;
      } else {
        tokens.forEach(it => {
          const div = document.createElement('div');
          div.className = 'token';
          div.innerHTML = `
            <div style="display:flex;gap:8px;align-items:center">
              <img src="${it.logo || 'https://via.placeholder.com/24?text=?'}" alt="${it.symbol}" style="width:24px;height:24px;border-radius:6px">
              <div>
                <div><b style="color:var(--neon)">${it.symbol || '?'}</b> ‚Äî ${it.name || 'Unnamed'}</div>
                <div class="tiny">üíß $${(it.liquidity || 0).toLocaleString()} ‚Ä¢ üßÆ FDV: $${(it.fullyDilutedValuation || 0).toLocaleString()}</div>
              </div>
            </div>
            <div class="tiny">${new Date(it.createdAt).toLocaleTimeString()}</div>
          `;
          tokenContainer.appendChild(div);
        });
      }
      debugLog(`Rendered ${tokens.length} tokens`);
    }

    refreshBtn.addEventListener('click', () => fetchTokens());
    fetchTokens(); // Initial fetch
    setInterval(() => fetchTokens(), 60000); // Auto-refresh every 60 detik
  </script>
</body>
</html>
